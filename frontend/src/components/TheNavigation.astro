---
import MenuAnimation from "./MenuAnimation";
import Icon from "./Icon.astro";
---

<!-- TheNavigation.astro -->
<nav class="menu" aria-label="Main navigation">
  <button
    class="btn menu__toggle"
    aria-expanded="false"
    aria-controls="menu-list"
  >
    <span class="menu__label menu__label--menu">
      Menu
      <Icon
        name="menu"
        title="Open menu"
        color="var(--clr-primary)"
        size={26}
        class="menu__icon"
      />
    </span>
    <span class="menu__label menu__label--close hidden">
      Close
      <Icon
        name="close"
        title="Close menu"
        color="var(--clr-primary)"
        size={26}
        class="menu__icon"
      />
    </span>
  </button>

  <div class="menu__wrapper" id="menu-wrapper">
    <ul class="menu__list" id="menu-list">
      <li class="menu__item">
        <a href="/" class="menu__link" data-astro-prefetch>Home</a>
      </li>

      <li class="menu__item"><a href="/blog" class="menu__link">Blog</a></li>
      <li class="menu__item">
        <a href="/contact" class="menu__link">Contact</a>
      </li>
    </ul>
  </div>
</nav>
<!-- <MenuAnimation client:only /> -->
<!-- only client: only wortks clien tmedia renders an error -->
<MenuAnimation client:media="(max-width: 768px)" />

<style>
  .menu__wrapper {
    position: absolute;
    top: 3.5rem;
    left: 1rem;
    right: 1rem;
    margin: 0 auto;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    background: var(--clr-neutral-light, #fff);
    border-radius: 0.75rem;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    transform: translateY(-10px) scale(0.98);
    transition:
      max-height 0.4s ease,
      opacity 0.4s ease,
      transform 0.3s ease;
    z-index: 1000;
  }

  .menu__wrapper.is-open {
    max-height: 500px;
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  .menu__toggle {
    color: var(--clr-primary);
    padding: 0.25rem 0.5rem;
    border: 1px solid var(--clr-secondary);
    border-radius: var(--border-radius);
    background: transparent;
    cursor: pointer;
    position: relative;
  }

  .menu__label {
    display: inline-flex;
    font-weight: var(--fw-bold);
    font-size: var(--fs-sm);
  }

  .menu__item {
    font-weight: var(--fw-bold);
    letter-spacing: var(--letter-spacing);
  }

  /* Hides inactive label */
  .hidden {
    display: none;
  }

  .menu__list {
    padding: var(--spacing-md);
    list-style: none;
  }

  .menu__item:not(:last-child) {
    margin-bottom: var(--spacing-sm);
  }

  .menu__item a {
    color: var(--clr-primary);
    text-decoration: none;
    font-size: var(--fs-body-fluid);
  }

  .menu__item a:hover {
    color: var(--clr-secondary);
  }

  /* mq responsive menu  */
  @media (width > 768px) {
    .menu__toggle {
      display: none;
    }
    .menu__wrapper {
      all: unset; /* resets height, position, overflow, etc. */
    }
    .menu__list {
      display: flex;
      flex-direction: row;
      gap: var(--spacing-md);
      padding: 0;
    }
    .menu__item {
      margin-bottom: 0;
    }
    .menu__item a:hover {
      color: var(--clr-secondary);
      transition: all var(--transition-duration);
    }
  }
  @media (width < 768px) {
    .menu__item:not(:last-child) {
      margin-bottom: var(--spacing-lg);
    }
  }
</style>
