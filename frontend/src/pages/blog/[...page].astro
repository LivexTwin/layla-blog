---
// .src/pages/blog/[...page].astro
import Layout from "@/layouts/Layout.astro";
import BlogLayout from "@/components/BlogLayout.astro";

import { getBlogIndexData } from "@/utils/getBlogIndexData";

export async function getStaticPaths({ paginate }) {
  const { posts } = await getBlogIndexData({});

  return paginate(posts, {
    pageSize: 9, // ðŸ‘ˆ change if you want more per page
  });
}

const { page } = Astro.props;

const SITE_URL = import.meta.env.PUBLIC_SITE_URL;

// fetch all posts, all categories
// and pass them to the BlogLayout component
const { categories } = await getBlogIndexData({});

const seo = {
  title: "Blog - Healing with Layla",
  description: "Read the latest therapy tips and posts.",
};
---

<Layout
  pageTitle={seo.title}
  pageDescription={seo.description}
  canonicalPath="/blog"
>
  <BlogLayout
    posts={page.data}
    categories={categories}
    categorySlug
    prevUrl={page.url.prev}
    nextUrl={page.url.next}
    currentPage={page.currentPage}
    lastPage={page.lastPage}
  />
</Layout>
